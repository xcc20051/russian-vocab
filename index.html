<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ä¿„è¯­ç¬¬16è¯¾ Â· æ™ºèƒ½èƒŒè¯å¢å¼ºç‰ˆ</title>
<style>
    :root {
        --primary: #3498db;
        --secondary: #95a5a6;
        --accent: #e67e22;
        --error: #e74c3c;
        --success: #27ae60;
    }
    body {
        font-family: "Segoe UI", "PingFang SC", "Microsoft YaHei", sans-serif;
        background: #f4f6f8;
        padding: 20px;
        color: #222;
        max-width: 800px;
        margin: 0 auto;
    }
    h1 { text-align: center; color: #2c3e50; }
    
    .controls {
        text-align: center;
        margin-bottom: 20px;
        position: sticky;
        top: 0;
        z-index: 100;
        background: rgba(244, 246, 248, 0.95);
        padding: 15px;
        border-bottom: 2px solid #ddd;
    }
    
    button {
        background: var(--primary);
        color: white;
        border: none;
        padding: 10px 18px;
        margin: 5px;
        border-radius: 6px;
        cursor: pointer;
        font-size: 14px;
        box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        transition: 0.2s;
    }
    button:hover { opacity: 0.9; transform: translateY(-1px); }
    button.secondary { background: var(--secondary); }
    button.test-btn { background: var(--accent); }
    button.clear-btn { background: #555; font-size: 12px; padding: 5px 10px; }

    .word-container { display: flex; flex-direction: column; }
    .word {
        background: white;
        margin: 10px 0;
        padding: 18px;
        border-radius: 10px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.05);
        display: flex;
        justify-content: space-between;
        align-items: center;
        border-left: 5px solid transparent;
    }
    .word.is-wrong { border-left-color: var(--error); }
    
    .left-part { flex: 1; }
    .ru { font-size: 24px; font-weight: bold; color: #2c3e50; }
    .cn { margin-top: 8px; color: var(--success); font-size: 17px; font-weight: 600; }

    /* æµ‹éªŒä¸çº é”™æ ·å¼ */
    .test-input {
        width: 90%;
        padding: 10px;
        font-size: 18px;
        border: 2px solid #eee;
        border-radius: 6px;
        margin-top: 10px;
        outline: none;
        transition: border 0.3s;
    }
    .test-input:focus { border-color: var(--primary); }
    
    .diff-result {
        margin-top: 10px;
        font-family: "Consolas", monospace;
        font-size: 18px;
        padding: 8px;
        background: #fdfdfd;
        border: 1px solid #eee;
        border-radius: 6px;
    }
    .char-correct { color: var(--success); }
    .char-wrong { color: var(--error); text-decoration: underline; font-weight: bold; background: #fff0f0; }
    .char-missing { color: #bbb; border-bottom: 2px dashed #ccc; }

    /* é”™é¢˜æœ¬åŒºåŸŸ */
    #wrongBookSection {
        margin-top: 40px;
        padding: 20px;
        background: #fff0f0;
        border-radius: 12px;
        border: 2px dashed var(--error);
        display: none;
    }
    #wrongBookSection h2 { color: var(--error); margin-top: 0; }

    .audio-btn {
        background: #f0f0f0;
        border-radius: 50%;
        width: 40px;
        height: 40px;
        display: flex;
        align-items: center;
        justify-content: center;
        cursor: pointer;
        font-size: 20px;
    }
    .tip {
        margin: 15px 0;
        background: #fffbe6;
        padding: 12px;
        border-left: 6px solid #f1c40f;
        font-size: 14px;
        border-radius: 4px;
    }
</style>
</head>
<body>

<h1>ä¿„è¯­èƒŒå•è¯ Â· ç¬¬16è¯¾</h1>

<div class="tip" id="modeTip">
ğŸ’¡ å½“å‰æ¨¡å¼ï¼š<b>æµè§ˆæ¨¡å¼</b>ã€‚
</div>

<div class="controls">
    <button onclick="shuffleWords()">ğŸ”€ éšæœºä¹±åº</button>
    <button id="toggleModeBtn" class="test-btn" onclick="toggleTestMode()">âœï¸ è¿›å…¥é»˜å†™æ¨¡å¼</button>
    <span id="viewControls">
        <button class="secondary" onclick="toggleAll(true)">ğŸ‘ï¸ æ˜¾ç¤ºå…¨éƒ¨</button>
        <button class="secondary" onclick="toggleAll(false)">ğŸ™ˆ éšè—å…¨éƒ¨</button>
    </span>
</div>

<div id="wordList" class="word-container"></div>

<div id="wrongBookSection">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h2>ğŸš© é”™é¢˜æœ¬ (åŠ æ²¹ï¼Œè¿™äº›è¿˜æ²¡æŒæ¡)</h2>
        <button class="clear-btn" onclick="clearWrongBook()">æ¸…ç©ºè®°å½•</button>
    </div>
    <div id="wrongList" class="word-container"></div>
</div>

<script>
// æ•°æ®æº
const originalData = [
    {ru: "ÑƒÑ‚Ñ€Ğ¾", cn: "æ—©æ™¨"}, {ru: "Ñ‡Ğ°ÑÑ‹", cn: "é’Ÿï¼›å°æ—¶"}, {ru: "Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€ÑÑ‚ÑŒ", cn: "æ£€æŸ¥ï¼ˆæœªå®Œæˆä½“ï¼‰"},
    {ru: "Ğ¿Ñ€Ğ¾Ğ²ĞµÑ€Ğ¸Ñ‚ÑŒ", cn: "æ£€æŸ¥ï¼ˆå®Œæˆä½“ï¼‰"}, {ru: "Ñ‚Ğ¾Ñ‡Ğ½Ğ¾", cn: "å‡†ç¡®åœ°ï¼›å‡†æ—¶"}, {ru: "Ğ½ÑƒĞ¶Ğ½Ğ¾", cn: "éœ€è¦ï¼›å¿…é¡»"},
    {ru: "Ğ·Ğ´Ğ¾Ñ€Ğ¾Ğ² â‰  Ğ±Ğ¾Ğ»ĞµĞ½", cn: "å¥åº·çš„ â‰  ç”Ÿç—…çš„"}, {ru: "Ğ²Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ â‰  Ğ²Ñ‹Ñ…Ğ¾Ğ´Ğ¸Ñ‚ÑŒ", cn: "è¿›å…¥ â‰  å‡ºå»"},
    {ru: "Ğ²Ğ¿ĞµÑ€ĞµĞ´Ğ¸ â‰  ÑzaĞ´Ğ¸", cn: "å‰é¢ â‰  åé¢"}, {ru: "ĞºĞ¾Ğ½Ñ‡Ğ°Ñ‚ÑŒÑÑ â‰  Ğ½Ğ°Ñ‡Ğ¸Ğ½Ğ°Ñ‚ÑŒÑÑ", cn: "ç»“æŸ â‰  å¼€å§‹"},
    {ru: "ÑĞ¿ĞµÑˆĞ¸Ñ‚ÑŒ", cn: "ç€æ€¥ï¼›èµ¶æ—¶é—´"}, {ru: "Ğ¾ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°", cn: "è½¦ç«™ï¼›ç«™ç‚¹"}, {ru: "Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ°", cn: "å·¥ä½œ"},
    {ru: "Ñ€Ğ°Ğ±Ğ¾Ñ‡Ğ¸Ğ¹", cn: "å·¥ä½œçš„ï¼›å·¥äºº"}, {ru: "Ğ¾ÑĞµĞ½ÑŒ", cn: "ç§‹å¤©"}, {ru: "Ğ¾ÑĞµĞ½ÑŒÑ", cn: "åœ¨ç§‹å¤©"},
    {ru: "Ğ¾ÑĞµĞ½Ğ½Ğ¸Ğ¹", cn: "ç§‹å¤©çš„"}, {ru: "Ğ´ĞµĞ½ÑŒ", cn: "ç™½å¤©ï¼›ä¸€å¤©"}, {ru: "Ğ´Ğ¾Ğ¶Ğ´ÑŒ", cn: "é›¨"},
    {ru: "ÑĞ¾Ğ»Ğ½Ñ†Ğµ", cn: "å¤ªé˜³"}, {ru: "Ğ¼Ğ¾Ğ¶ĞµÑ‚ Ğ±Ñ‹Ñ‚ÑŒ", cn: "å¯èƒ½ï¼›ä¹Ÿè®¸"}, {ru: "Ğ½Ğ°Ğ¿Ñ€Ğ¾Ñ‚Ğ¸Ğ²", cn: "åœ¨â€¦â€¦å¯¹é¢"},
    {ru: "ÑĞ²ĞµÑ‚Ğ¸Ñ‚ÑŒ", cn: "ç…§è€€ï¼›å‘å…‰"}, {ru: "Ğ½ĞµĞ±Ğ¾", cn: "å¤©ç©º"}, {ru: "Ğ³Ğ¾Ğ»ÑƒĞ±Ğ¾Ğ¹", cn: "æµ…è“è‰²"},
    {ru: "Ğ·ĞµĞ»Ñ‘Ğ½Ñ‹Ğ¹", cn: "ç»¿è‰²"}, {ru: "Ğ¶Ñ‘Ğ»Ñ‚Ñ‹Ğ¹", cn: "é»„è‰²"}, {ru: "Ğ´ĞµÑ€ĞµĞ²Ğ¾ / Ğ´ĞµÑ€ĞµĞ²ÑŒÑ", cn: "æ ‘ï¼ˆå•æ•° / å¤æ•°ï¼‰"},
    {ru: "ĞºÑƒĞ¿Ğ¸Ñ‚ÑŒ", cn: "ä¹°ï¼ˆå®Œæˆä½“ï¼‰"}, {ru: "Ğ¾Ğ´ĞµĞ¶Ğ´Ğ°", cn: "è¡£æœ"}, {ru: "ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸Ñ‡ĞµÑĞºĞ¸Ğ¹", cn: "ç»æµçš„"},
    {ru: "ÑĞºĞ¾Ğ½Ğ¾Ğ¼Ğ¸ÑÑ‚", cn: "ç»æµå­¦å®¶"}, {ru: "Ğ´Ñ€ÑƒĞ¶Ğ±Ğ°", cn: "å‹è°Š"}
];

let wordData = [...originalData];
let isTestMode = false;
let wrongWords = new Set(); // ä½¿ç”¨Setè®°å½•é”™é¢˜ï¼Œé¿å…é‡å¤

// åˆå§‹åŒ–æ¸²æŸ“
function renderWords() {
    const list = document.getElementById('wordList');
    list.innerHTML = '';
    wordData.forEach((item, index) => {
        list.appendChild(createWordElement(item, index, "main"));
    });
    updateWrongBookUI();
}

// åˆ›å»ºå•è¯HTMLå…ƒç´ 
function createWordElement(item, index, listType) {
    const wordDiv = document.createElement('div');
    wordDiv.className = 'word';
    const idPrefix = listType === "main" ? `main-${index}` : `wrong-${index}`;

    if (!isTestMode) {
        wordDiv.innerHTML = `
            <div class="left-part" onclick="toggle(this)">
                <div class="ru">${item.ru}</div>
                <div class="cn" style="display:none">${item.cn}</div>
            </div>
            <div class="audio-btn" onclick="speak('${item.ru}')">ğŸ”Š</div>
        `;
    } else {
        wordDiv.innerHTML = `
            <div class="left-part">
                <div class="cn" style="display:block">${item.cn}</div>
                <input type="text" class="test-input" placeholder="æ‹¼å†™ä¿„è¯­..." 
                    oninput="checkWord(this, '${item.ru}', '${idPrefix}')">
                <div id="diff-${idPrefix}" class="diff-result" style="display:none"></div>
            </div>
            <div class="audio-btn" onclick="speak('${item.ru}')">ğŸ”Š</div>
        `;
    }
    return wordDiv;
}

// æ ¸å¿ƒæ¯”å¯¹ä¸é”™é¢˜è®°å½•
function checkWord(inputEl, correctWord, id) {
    const userInput = inputEl.value.trim().toLowerCase();
    const target = correctWord.toLowerCase();
    const diffDiv = document.getElementById(`diff-${id}`);
    
    if (userInput === "") {
        diffDiv.style.display = 'none';
        return;
    }
    
    diffDiv.style.display = 'block';
    
    // é€»è¾‘ï¼šå¦‚æœè¾“å…¥é•¿åº¦è¾¾åˆ°æ­£ç¡®å•è¯çš„ä¸€åŠï¼Œä¸”ä¾ç„¶ä¸åŒ¹é…ï¼Œåˆ™åŠ å…¥é”™é¢˜æœ¬
    if (userInput !== target && userInput.length >= target.length / 2) {
        if (!wrongWords.has(correctWord)) {
            wrongWords.add(correctWord);
            updateWrongBookUI();
        }
    }

    if (userInput === target) {
        diffDiv.innerHTML = `<span class="char-correct">âœ“ å¤ªæ£’äº†ï¼Œæ‹¼å†™æ­£ç¡®!</span>`;
        return;
    }

    // é€å­—å¯¹æ¯”
    let resultHtml = "";
    const maxLength = Math.max(userInput.length, target.length);
    for (let i = 0; i < maxLength; i++) {
        const u = userInput[i];
        const t = target[i];
        if (u === t) resultHtml += `<span class="char-correct">${u}</span>`;
        else if (u === undefined) resultHtml += `<span class="char-missing">${t}</span>`;
        else resultHtml += `<span class="char-wrong">${u}</span>`;
    }
    diffDiv.innerHTML = `çº é”™ï¼š${resultHtml} <br><small style="color:#888">å‚è€ƒï¼š${correctWord}</small>`;
}

// æ›´æ–°é”™é¢˜æœ¬æ˜¾ç¤º
function updateWrongBookUI() {
    const section = document.getElementById('wrongBookSection');
    const list = document.getElementById('wrongList');
    
    if (wrongWords.size === 0) {
        section.style.display = 'none';
        return;
    }

    section.style.display = 'block';
    list.innerHTML = '';
    
    // ä»åŸå§‹æ•°æ®ä¸­æ‰¾å‡ºå¯¹åº”çš„é”™é¢˜ä¿¡æ¯
    Array.from(wrongWords).forEach((wrongRu, index) => {
        const item = originalData.find(d => d.ru === wrongRu);
        if (item) {
            list.appendChild(createWordElement(item, index, "wrong"));
        }
    });
}

function clearWrongBook() {
    wrongWords.clear();
    updateWrongBookUI();
}

function toggleTestMode() {
    isTestMode = !isTestMode;
    const btn = document.getElementById('toggleModeBtn');
    const viewControls = document.getElementById('viewControls');
    const tip = document.getElementById('modeTip');
    
    if (isTestMode) {
        btn.innerText = "ğŸ“– è¿”å›æµè§ˆæ¨¡å¼";
        viewControls.style.display = 'none';
        tip.innerHTML = "âœï¸ <b>é»˜å†™æ¨¡å¼</b>ï¼šæ‹¼å†™é”™è¯¯å°†è‡ªåŠ¨è®°å…¥åº•éƒ¨çš„ã€é”™é¢˜æœ¬ã€‘ã€‚";
    } else {
        btn.innerText = "âœï¸ è¿›å…¥é»˜å†™æ¨¡å¼";
        viewControls.style.display = 'inline';
        tip.innerHTML = "ğŸ’¡ <b>æµè§ˆæ¨¡å¼</b>ï¼šç‚¹å‡»å•è¯å¯æŸ¥çœ‹ç¿»è¯‘ã€‚";
    }
    renderWords();
}

// åŸºç¡€è¾…åŠ©å‡½æ•°
function toggle(el) {
    const cn = el.querySelector('.cn');
    cn.style.display = (cn.style.display === 'none') ? 'block' : 'none';
}
function toggleAll(show) {
    document.querySelectorAll('.cn').forEach(cn => cn.style.display = show ? 'block' : 'none');
}
function shuffleWords() {
    wordData.sort(() => Math.random() - 0.5);
    renderWords();
}
function speak(text) {
    const msg = new SpeechSynthesisUtterance();
    msg.text = text;
    msg.lang = 'ru-RU';
    window.speechSynthesis.speak(msg);
}

// åˆå§‹åŠ è½½
renderWords();
</script>

</body>
</html>

